#include <xc.h>
#include "lcd.h"
#include "libpic30.h"
#include <stdint.h>
#include <string.h>

#define FCY 4000000UL
#define SYMBOL_HEART 0

const uint8_t heart_symbol[8] = {
    0b01010,
    0b11111,
    0b11111,
    0b01110,
    0b00100,
    0b00000,
    0b00000,
    0b00000
};

void delay_ms(unsigned long ms) {
    __delay32((FCY / 1000) * ms);
}

const char reklama[] = "  Kup PIC – programuj z mocą!   ";

void wyswietl_reklame(const char *tekst) {
    char bufor[17];
    size_t len = strlen(tekst);

    for (size_t i = 0; i < len - 15; i++) {
        strncpy(bufor, &tekst[i], 15); // 15 znaków na tekst, 1 na serce
        bufor[15] = '\0';

        LCD_ClearScreen();
        LCD_PutChar(SYMBOL_HEART); // ♥ przed tekstem
        LCD_PutString(bufor, strlen(bufor));
        delay_ms(300);
    }
}

int main(void) {
    LCD_Initialize();
    LCD_ClearScreen();

    LCD_CreateChar(SYMBOL_HEART, heart_symbol);

    LCD_PutChar(SYMBOL_HEART);
    LCD_PutString(" Witaj w PIC!", 14);
    delay_ms(1500);

    while (1) {
        wyswietl_reklame(reklama);
    }

    return 0;
}
